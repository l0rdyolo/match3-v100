{"version":3,"sources":["file:///C:/Users/maide/OneDrive/Documents/GitHub/match3-v100/assets/Scripts/SooLib/Runtime/TaskSystem/AsyncLock.ts"],"names":["AsyncLock","_queue","_locked","acquire","unlock","next","shift","Promise","resolve","tryLock","push"],"mappings":";;;iBAAaA,S;;;;;;;;;;;;;2BAAAA,S,GAAN,MAAMA,SAAN,CAAgB;AAAA;AAAA,eACXC,MADW,GACc,EADd;AAAA,eAEXC,OAFW,GAEQ,KAFR;AAAA;;AAIZC,QAAAA,OAAO,GAAwB;AAClC,cAAMC,MAAM,GAAG,MAAM;AACjB,iBAAKF,OAAL,GAAe,KAAf;;AACA,gBAAMG,IAAI,GAAG,KAAKJ,MAAL,CAAYK,KAAZ,EAAb;;AACA,gBAAID,IAAJ,EAAU;AACNA,cAAAA,IAAI;AACP;AACJ,WAND;;AAQA,iBAAO,IAAIE,OAAJ,CAAYC,OAAO,IAAI;AAC1B,gBAAMC,OAAO,GAAG,MAAM;AAClB,kBAAI,CAAC,KAAKP,OAAV,EAAmB;AACf,qBAAKA,OAAL,GAAe,IAAf;AACAM,gBAAAA,OAAO,CAACJ,MAAD,CAAP;AACH,eAHD,MAGO;AACH,qBAAKH,MAAL,CAAYS,IAAZ,CAAiBD,OAAjB;AACH;AACJ,aAPD;;AASAA,YAAAA,OAAO;AACV,WAXM,CAAP;AAYH;;AAzBkB,O","sourcesContent":["export class AsyncLock {\n    private _queue: (() => void)[] = [];\n    private _locked: boolean = false;\n\n    public acquire(): Promise<() => void> {\n        const unlock = () => {\n            this._locked = false;\n            const next = this._queue.shift();\n            if (next) {\n                next();\n            }\n        };\n\n        return new Promise(resolve => {\n            const tryLock = () => {\n                if (!this._locked) {\n                    this._locked = true;\n                    resolve(unlock);\n                } else {\n                    this._queue.push(tryLock);\n                }\n            };\n\n            tryLock();\n        });\n    }\n}\n"]}