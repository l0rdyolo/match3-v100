{"version":3,"sources":["file:///C:/Users/maide/OneDrive/Documents/GitHub/match3-v100/assets/Scripts/Effects/EffectManager.ts"],"names":["_decorator","Component","tween","Vec3","sleep","ccclass","property","EffectManager","decreaseScale","target","duration","yoyo","Promise","resolve","to","scale","ZERO","call","ONE","start","movePiece","position","fallPieceToGridPosition","delay","animateRowFall","pieceProps","promises","map","piece","targetPosition","all","highlightPiece","shakePiece","originalPosition","getPosition","shakeAmount","by","setPosition"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, tween, Vec2, Vec3 } from \"cc\";\r\nimport { sleep } from \"../Promises\";\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass(\"EffectManager\")\r\nexport class EffectManager extends Component {\r\n  public static async decreaseScale(\r\n    target: Node,\r\n    duration: number,\r\n    yoyo: boolean\r\n  ): Promise<void> {\r\n    return new Promise<void>((resolve) => {\r\n      tween(target)\r\n        .to(duration, { scale: Vec3.ZERO })\r\n        .call(() => {\r\n          resolve();\r\n          if (yoyo) {\r\n            tween(target).to(duration, { scale: Vec3.ONE }).start();\r\n          }\r\n        })\r\n        .start();\r\n    });\r\n  }\r\n\r\n  public static async movePiece(\r\n    target: Node,\r\n    to: Vec3,\r\n    duration: number\r\n  ): Promise<void> {\r\n    return new Promise<void>((resolve) => {\r\n      tween(target)\r\n        .to(duration, {\r\n          position: to,\r\n        })\r\n        .call(() => {\r\n          resolve();\r\n        })\r\n        .start();\r\n    });\r\n  }\r\n\r\n  public static async fallPieceToGridPosition(\r\n    target: Node,\r\n    to: Vec3,\r\n    duration: number,\r\n    delay: number\r\n  ): Promise<void> {\r\n    await sleep(delay);\r\n    return new Promise<void>((resolve) => {\r\n      tween(target)\r\n        .to(duration, { position: to })\r\n        .call(() => {\r\n          resolve();\r\n        })\r\n        .start();\r\n    });\r\n  }\r\n\r\n  public static async animateRowFall(\r\n    pieceProps: any[],\r\n    duration: number,\r\n    delay: number = 0\r\n  ) {\r\n    const promises = pieceProps.map((pieceProps) => {\r\n      return this.fallPieceToGridPosition(\r\n        pieceProps.piece,\r\n        pieceProps.targetPosition,\r\n        duration,\r\n        delay\r\n      );\r\n    });\r\n    await Promise.all(promises);\r\n  }\r\n\r\n  public static highlightPiece(piece: Node) {\r\n    // piece.setScale(1.2, 1.2, 1.2);\r\n    tween(piece)\r\n    .to(0.1,{scale : new Vec3(1.2,1.2,1.2)})\r\n    .start();\r\n  }\r\n\r\n  public static async shakePiece(piece: Node, duration: number = 0.2): Promise<void> {\r\n    const originalPosition = piece.getPosition();\r\n    const shakeAmount = 10; // Sarsılma miktarı\r\n\r\n    return new Promise<void>((resolve) => {\r\n        tween(piece)\r\n            .by(duration / 4, { position: new Vec3(shakeAmount, 0, 0) }) \r\n            .by(duration / 4, { position: new Vec3(-shakeAmount * 2, 0, 0) }) \r\n            .by(duration / 4, { position: new Vec3(shakeAmount * 2, 0, 0) }) \r\n            .by(duration / 4, { position: new Vec3(-shakeAmount, 0, 0) }) \r\n            .call(() => {\r\n                piece.setPosition(originalPosition); \r\n                resolve();\r\n            })\r\n            .start();\r\n    });\r\n}\r\n}\r\n"]}