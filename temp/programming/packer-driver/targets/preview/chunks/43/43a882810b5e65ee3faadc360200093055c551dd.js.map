{"version":3,"sources":["file:///C:/Users/maide/OneDrive/Masa%C3%BCst%C3%BC/match3-2d/assets/Scripts/Interaction/InteractionManager.ts"],"names":["_decorator","Component","Vec3","MatchChecker","EffectManager","ccclass","property","InteractionManager","grid","firstSelectedPiece","secondSelectedPiece","initializeGrid","onPieceClicked","event","piece","console","log","subtract","position","normalize","pieceA","pieceB","posA","getPosition","posB","swapPositions","rowA","findPieceRow","colA","findPieceCol","rowB","colB","checkMatch","resetSelection","highlightPiece","setScale","movePiece"],"mappings":"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","sourcesContent":["import { _decorator, Component, EventTouch, Node, tween, Vec3 } from 'cc';\nimport { MatchChecker } from '../Grid/MatchChecker';\nimport { EffectManager } from '../Effects/EffectManager';\nconst { ccclass , property } = _decorator;\n\n@ccclass('InteractionManager')\nexport class InteractionManager extends Component {\n    private grid: Node[][] = [];\n    // private selectedPiece: Node | null = null;\n    private firstSelectedPiece : Node | null = null;\n    private secondSelectedPiece : Node | null = null;\n\n\n    public initializeGrid(grid: Node[][]) {\n        this.grid = grid;\n    }\n\n    public async onPieceClicked(event: EventTouch, piece: Node) {\n        if (this.firstSelectedPiece) {\n            this.secondSelectedPiece = piece;\n\n            console.log(Vec3.subtract(new Vec3 , this.firstSelectedPiece.position , this.secondSelectedPiece.position).normalize);\n            \n\n            const pieceA = this.secondSelectedPiece;\n            const pieceB = this.firstSelectedPiece;\n\n            const posA = pieceA.getPosition();\n            const posB = pieceB.getPosition();\n\n            //swapHere\n            this.swapPositions(pieceA,pieceB ,posA,posB);\n\n            const rowA = this.findPieceRow(pieceA);\n            const colA = this.findPieceCol(pieceA);\n            const rowB = this.findPieceRow(pieceB);\n            const colB = this.findPieceCol(pieceB);\n            console.log(MatchChecker.checkMatch(this.grid, pieceA, rowA, colA) , MatchChecker.checkMatch(this.grid, pieceB, rowB, colB));\n            \n            if (!MatchChecker.checkMatch(this.grid, pieceA, rowB, colB) && !MatchChecker.checkMatch(this.grid, pieceB, rowA, colA)) {\n                // Swap back if no match\n                console.log(\"nasÄ±l\");\n                \n                // tween(pieceA).to(0.3, { position: posA }).start();\n                // tween(pieceB).to(0.3, { position: posB }).start();\n            }\n            this.resetSelection();\n        } else {\n            this.firstSelectedPiece = piece;\n            console.log(\"first selection\",piece);\n            \n            this.highlightPiece(piece);\n        }\n    }\n\n    private findPieceRow(piece: Node): number {\n        // Implement logic to find the row of the piece in the grid.\n        // Example: return this.grid.findIndex(row => row.includes(piece));\n        return -1; // Placeholder, implement this logic.\n    }\n\n    private findPieceCol(piece: Node): number {\n        // Implement logic to find the column of the piece in the grid.\n        // Example: return this.grid[row].indexOf(piece);\n        return -1; // Placeholder, implement this logic.\n    }\n\n    private highlightPiece(piece: Node) {\n        piece.setScale(1.2, 1.2, 1.2);\n    }\n\n    private swapPositions(pieceA : Node , pieceB : Node ,posA:Vec3,posB:Vec3 ){\n        EffectManager.movePiece(pieceA , posB , 0.1);\n        EffectManager.movePiece(pieceB , posA , 0.1);\n    }\n\n    private resetSelection(){\n        this.firstSelectedPiece!.setScale(1,1,1)\n        this.secondSelectedPiece!.setScale(1,1,1)\n        this.firstSelectedPiece = null;\n        this.secondSelectedPiece = null;\n    }\n\n}\n"]}