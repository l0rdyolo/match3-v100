{"version":3,"sources":["file:///C:/Users/maide/OneDrive/Documents/GitHub/match3-v100/assets/SooLib/Optimization/Poolable.ts"],"names":["_decorator","Component","instantiate","Prefab","Vec3","Quat","ObjectPooling","ccclass","property","Poolable","pool","Pool","onObjectAcquired","obj","active","onObjectReleased","setParent","node","setPosition","ZERO","setScale","ONE","setRotation","creator","poolObject","onLoad","list","i","maxCount","push"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,I,OAAAA,I;;AAC3CC,MAAAA,a,iBAAAA,a;;;;;;;;;OAChB;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBR,U,GAE9B;;0BAEsBS,Q,WADrBF,OAAO,CAAC,UAAD,C,UAEHC,QAAQ,CAACL,MAAD,C,2BAFb,MACsBM,QADtB,SACuCR,SADvC,CACiD;AAAA;AAAA;;AAAA;;AAAA;;AAAA,eAOnCS,IAPmC;AAAA;;AAS9B,YAAJC,IAAI,GAAsB;AACjC,iBAAO,KAAKD,IAAZ;AACH;;AAESE,QAAAA,gBAAgB,CAACC,GAAD,EAAkB;AACxCA,UAAAA,GAAG,CAACC,MAAJ,GAAa,IAAb,CADwC,CAExC;AACH;;AAESC,QAAAA,gBAAgB,CAACF,GAAD,EAAkB;AACxCA,UAAAA,GAAG,CAACC,MAAJ,GAAa,KAAb;AACAD,UAAAA,GAAG,CAACG,SAAJ,CAAc,KAAKC,IAAnB;AACAJ,UAAAA,GAAG,CAACK,WAAJ,CAAgBd,IAAI,CAACe,IAArB;AACAN,UAAAA,GAAG,CAACO,QAAJ,CAAahB,IAAI,CAACiB,GAAlB;AACAR,UAAAA,GAAG,CAACS,WAAJ,CAAgB,IAAIjB,IAAJ,EAAhB,EALwC,CAMxC;AACH;;AAESkB,QAAAA,OAAO,GAAS;AACtB,cAAMV,GAAG,GAAGX,WAAW,CAAC,KAAKsB,UAAN,CAAvB;AACAX,UAAAA,GAAG,CAACG,SAAJ,CAAc,KAAKC,IAAnB;AACA,iBAAOJ,GAAP;AACH;;AAESY,QAAAA,MAAM,GAAS;AACrB,cAAMC,IAAY,GAAG,EAArB;;AACA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKC,QAAzB,EAAmCD,CAAC,EAApC,EAAwC;AACpC,gBAAMd,GAAG,GAAG,KAAKU,OAAL,EAAZ;AACAV,YAAAA,GAAG,CAACC,MAAJ,GAAa,KAAb;AACAY,YAAAA,IAAI,CAACG,IAAL,CAAUhB,GAAV;AACH;;AAED,eAAKH,IAAL,GAAY;AAAA;AAAA,8CACR,MAAM,KAAKa,OAAL,EADE,EAEPV,GAAD,IAAS,KAAKD,gBAAL,CAAsBC,GAAtB,CAFD,EAGPA,GAAD,IAAS,KAAKE,gBAAL,CAAsBF,GAAtB,CAHD,EAIRa,IAJQ,EAKR,KAAKE,QALG,EAMR,KAAKA,QANG,CAAZ;AAQH;;AAjD4C,O;;;;;iBAEd,I;;mFAE9BpB,Q;;;;;iBAC4B,E","sourcesContent":["import { _decorator, Component, Node, instantiate, Prefab, Vec3, Quat } from 'cc';\r\nimport { IObjectPool, ObjectPooling } from './ObjectPooling';\r\nconst { ccclass, property } = _decorator;\r\n\r\n// Define the Poolable abstract class\r\n@ccclass('Poolable')\r\nexport abstract class Poolable extends Component {\r\n    @property(Prefab)\r\n    protected poolObject: Prefab = null;\r\n\r\n    @property\r\n    protected maxCount: number = 20;\r\n\r\n    protected pool: IObjectPool<Node>;\r\n\r\n    public get Pool(): IObjectPool<Node> {\r\n        return this.pool\r\n    }\r\n\r\n    protected onObjectAcquired(obj: Node): void {\r\n        obj.active = true;\r\n        // other logics ...\r\n    }\r\n\r\n    protected onObjectReleased(obj: Node): void {\r\n        obj.active = false;\r\n        obj.setParent(this.node);\r\n        obj.setPosition(Vec3.ZERO);\r\n        obj.setScale(Vec3.ONE);\r\n        obj.setRotation(new Quat());\r\n        // other logics ...\r\n    }\r\n\r\n    protected creator(): Node {\r\n        const obj = instantiate(this.poolObject);\r\n        obj.setParent(this.node);\r\n        return obj;\r\n    }\r\n\r\n    protected onLoad(): void {\r\n        const list: Node[] = [];\r\n        for (let i = 0; i < this.maxCount; i++) {\r\n            const obj = this.creator();\r\n            obj.active = false;\r\n            list.push(obj);\r\n        }\r\n\r\n        this.pool = new ObjectPooling<Node>(\r\n            () => this.creator(),\r\n            (obj) => this.onObjectAcquired(obj),\r\n            (obj) => this.onObjectReleased(obj),\r\n            list,\r\n            this.maxCount,\r\n            this.maxCount\r\n        );\r\n    }\r\n}\r\n"]}