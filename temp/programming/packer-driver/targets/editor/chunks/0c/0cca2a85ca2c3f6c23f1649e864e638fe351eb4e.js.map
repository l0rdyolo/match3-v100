{"version":3,"sources":["file:///C:/Users/maide/OneDrive/Documents/GitHub/match3-v100/assets/Scripts/SooLib/Joystick/CanvasResolver.ts"],"names":["_decorator","Node","Vec3","UITransform","Component","Canvas","ccclass","property","CanvasResolver","canvasTransform","position","halfCanvasWidth","halfCanvasHeight","onLoad","canvas","getComponent","updateCanvasSize","node","on","EventType","SIZE_CHANGED","onDestroy","off","width","height","resolvePosition","event","location","touch","getUILocation","x","y","set"],"mappings":";;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,I,OAAAA,I;AAAkBC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,M,OAAAA,M;;;;;;;;;OAC/D;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;;gCAGjBQ,c,WADZF,OAAO,CAAC,gBAAD,C,UAEHC,QAAQ,CAACF,MAAD,C,2BAFb,MACaG,cADb,SACoCJ,SADpC,CAC8C;AAAA;AAAA;;AAAA;;AAAA,eAIlCK,eAJkC;AAAA,eAKzBC,QALyB,GAKR,IAAIR,IAAJ,EALQ;AAAA,eAMlCS,eANkC,GAMR,CANQ;AAAA,eAOlCC,gBAPkC,GAOP,CAPO;AAAA;;AAS1CC,QAAAA,MAAM,GAAG;AAAA;;AACL,eAAKJ,eAAL,mBAAuB,KAAKK,MAA5B,qBAAuB,aAAaC,YAAb,CAA0BZ,WAA1B,CAAvB;AACA,eAAKa,gBAAL;AACA,gCAAKF,MAAL,mCAAaG,IAAb,CAAkBC,EAAlB,CAAqBjB,IAAI,CAACkB,SAAL,CAAeC,YAApC,EAAkD,KAAKJ,gBAAvD,EAAyE,IAAzE;AACH;;AAEDK,QAAAA,SAAS,GAAG;AAAA;;AACR,gCAAKP,MAAL,mCAAaG,IAAb,CAAkBK,GAAlB,CAAsBrB,IAAI,CAACkB,SAAL,CAAeC,YAArC,EAAmD,KAAKJ,gBAAxD,EAA0E,IAA1E;AACH;;AAEOA,QAAAA,gBAAgB,GAAG;AAAA;;AACvB,eAAKL,eAAL,GAAuB,+BAAKF,eAAL,2CAAsBc,KAAtB,IAA8B,CAA9B,IAAmC,CAA1D;AACA,eAAKX,gBAAL,GAAwB,gCAAKH,eAAL,4CAAsBe,MAAtB,IAA+B,CAA/B,IAAoC,CAA5D;AACH;;AAEMC,QAAAA,eAAe,CAACC,KAAD,EAA0B;AAC5C,gBAAMC,QAAQ,GAAGD,KAAK,CAACE,KAAN,CAAYC,aAAZ,EAAjB;AACA,gBAAMC,CAAC,GAAGH,QAAQ,CAACG,CAAT,GAAa,KAAKnB,eAA5B;AACA,gBAAMoB,CAAC,GAAGJ,QAAQ,CAACI,CAAT,GAAa,KAAKnB,gBAA5B;AACA,eAAKF,QAAL,CAAcsB,GAAd,CAAkBF,CAAlB,EAAqBC,CAArB,EAAwB,CAAxB;AACA,iBAAO,KAAKrB,QAAZ;AACH;;AA9ByC,O","sourcesContent":["import { _decorator, Node, EventTouch, Vec3, UITransform, Component, Canvas } from \"cc\";\nconst { ccclass, property } = _decorator;\n\n@ccclass(\"CanvasResolver\")\nexport class CanvasResolver extends Component {\n    @property(Canvas)\n    private readonly canvas?: Canvas;\n\n    private canvasTransform?: UITransform;\n    private readonly position: Vec3 = new Vec3();\n    private halfCanvasWidth: number = 0;\n    private halfCanvasHeight: number = 0;\n\n    onLoad() {\n        this.canvasTransform = this.canvas?.getComponent(UITransform);\n        this.updateCanvasSize();\n        this.canvas?.node.on(Node.EventType.SIZE_CHANGED, this.updateCanvasSize, this);\n    }\n\n    onDestroy() {\n        this.canvas?.node.off(Node.EventType.SIZE_CHANGED, this.updateCanvasSize, this);\n    }\n\n    private updateCanvasSize() {\n        this.halfCanvasWidth = this.canvasTransform?.width / 2 || 0;\n        this.halfCanvasHeight = this.canvasTransform?.height / 2 || 0;\n    }\n\n    public resolvePosition(event: EventTouch): Vec3 {\n        const location = event.touch.getUILocation();\n        const x = location.x - this.halfCanvasWidth;\n        const y = location.y - this.halfCanvasHeight;\n        this.position.set(x, y, 0);\n        return this.position;\n    }\n}\n"]}