{"version":3,"sources":["file:///C:/Users/maide/OneDrive/Documents/GitHub/match3-v100/assets/Scripts/Effects/EffectManager.ts"],"names":["_decorator","Component","tween","Vec3","sleep","ccclass","property","EffectManager","decreaseScale","target","duration","yoyo","Promise","resolve","to","scale","ZERO","call","ONE","start","movePiece","position","fallPieceToGridPosition","delay","animateRowFall","pieceProps","promises","map","piece","targetPosition","all","highlightPiece","shakePiece","originalPosition","getPosition","shakeAmount","by","setPosition"],"mappings":";;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,K,OAAAA,K;AAAaC,MAAAA,I,OAAAA,I;;AAC1CC,MAAAA,K,iBAAAA,K;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;;+BAGjBO,a,WADZF,OAAO,CAAC,eAAD,C,gBAAR,MACaE,aADb,SACmCN,SADnC,CAC6C;AACV,qBAAbO,aAAa,CAC/BC,MAD+B,EAE/BC,QAF+B,EAG/BC,IAH+B,EAIhB;AACf,iBAAO,IAAIC,OAAJ,CAAmBC,OAAD,IAAa;AACpCX,YAAAA,KAAK,CAACO,MAAD,CAAL,CACGK,EADH,CACMJ,QADN,EACgB;AAAEK,cAAAA,KAAK,EAAEZ,IAAI,CAACa;AAAd,aADhB,EAEGC,IAFH,CAEQ,MAAM;AACVJ,cAAAA,OAAO;;AACP,kBAAIF,IAAJ,EAAU;AACRT,gBAAAA,KAAK,CAACO,MAAD,CAAL,CAAcK,EAAd,CAAiBJ,QAAjB,EAA2B;AAAEK,kBAAAA,KAAK,EAAEZ,IAAI,CAACe;AAAd,iBAA3B,EAAgDC,KAAhD;AACD;AACF,aAPH,EAQGA,KARH;AASD,WAVM,CAAP;AAWD;;AAE4B,qBAATC,SAAS,CAC3BX,MAD2B,EAE3BK,EAF2B,EAG3BJ,QAH2B,EAIZ;AACf,iBAAO,IAAIE,OAAJ,CAAmBC,OAAD,IAAa;AACpCX,YAAAA,KAAK,CAACO,MAAD,CAAL,CACGK,EADH,CACMJ,QADN,EACgB;AACZW,cAAAA,QAAQ,EAAEP;AADE,aADhB,EAIGG,IAJH,CAIQ,MAAM;AACVJ,cAAAA,OAAO;AACR,aANH,EAOGM,KAPH;AAQD,WATM,CAAP;AAUD;;AAE0C,qBAAvBG,uBAAuB,CACzCb,MADyC,EAEzCK,EAFyC,EAGzCJ,QAHyC,EAIzCa,KAJyC,EAK1B;AACf,gBAAM;AAAA;AAAA,8BAAMA,KAAN,CAAN;AACA,iBAAO,IAAIX,OAAJ,CAAmBC,OAAD,IAAa;AACpCX,YAAAA,KAAK,CAACO,MAAD,CAAL,CACGK,EADH,CACMJ,QADN,EACgB;AAAEW,cAAAA,QAAQ,EAAEP;AAAZ,aADhB,EAEGG,IAFH,CAEQ,MAAM;AACVJ,cAAAA,OAAO;AACR,aAJH,EAKGM,KALH;AAMD,WAPM,CAAP;AAQD;;AAEiC,qBAAdK,cAAc,CAChCC,UADgC,EAEhCf,QAFgC,EAGhCa,KAAa,GAAG,CAHgB,EAIhC;AACA,gBAAMG,QAAQ,GAAGD,UAAU,CAACE,GAAX,CAAgBF,UAAD,IAAgB;AAC9C,mBAAO,KAAKH,uBAAL,CACLG,UAAU,CAACG,KADN,EAELH,UAAU,CAACI,cAFN,EAGLnB,QAHK,EAILa,KAJK,CAAP;AAMD,WAPgB,CAAjB;AAQA,gBAAMX,OAAO,CAACkB,GAAR,CAAYJ,QAAZ,CAAN;AACD;;AAE2B,eAAdK,cAAc,CAACH,KAAD,EAAc;AACxC;AACA1B,UAAAA,KAAK,CAAC0B,KAAD,CAAL,CACCd,EADD,CACI,GADJ,EACQ;AAACC,YAAAA,KAAK,EAAG,IAAIZ,IAAJ,CAAS,GAAT,EAAa,GAAb,EAAiB,GAAjB;AAAT,WADR,EAECgB,KAFD;AAGD;;AAE6B,qBAAVa,UAAU,CAACJ,KAAD,EAAclB,QAAgB,GAAG,GAAjC,EAAqD;AACjF,gBAAMuB,gBAAgB,GAAGL,KAAK,CAACM,WAAN,EAAzB;AACA,gBAAMC,WAAW,GAAG,EAApB,CAFiF,CAEzD;;AAExB,iBAAO,IAAIvB,OAAJ,CAAmBC,OAAD,IAAa;AAClCX,YAAAA,KAAK,CAAC0B,KAAD,CAAL,CACKQ,EADL,CACQ1B,QAAQ,GAAG,CADnB,EACsB;AAAEW,cAAAA,QAAQ,EAAE,IAAIlB,IAAJ,CAASgC,WAAT,EAAsB,CAAtB,EAAyB,CAAzB;AAAZ,aADtB,EAEKC,EAFL,CAEQ1B,QAAQ,GAAG,CAFnB,EAEsB;AAAEW,cAAAA,QAAQ,EAAE,IAAIlB,IAAJ,CAAS,CAACgC,WAAD,GAAe,CAAxB,EAA2B,CAA3B,EAA8B,CAA9B;AAAZ,aAFtB,EAGKC,EAHL,CAGQ1B,QAAQ,GAAG,CAHnB,EAGsB;AAAEW,cAAAA,QAAQ,EAAE,IAAIlB,IAAJ,CAASgC,WAAW,GAAG,CAAvB,EAA0B,CAA1B,EAA6B,CAA7B;AAAZ,aAHtB,EAIKC,EAJL,CAIQ1B,QAAQ,GAAG,CAJnB,EAIsB;AAAEW,cAAAA,QAAQ,EAAE,IAAIlB,IAAJ,CAAS,CAACgC,WAAV,EAAuB,CAAvB,EAA0B,CAA1B;AAAZ,aAJtB,EAKKlB,IALL,CAKU,MAAM;AACRW,cAAAA,KAAK,CAACS,WAAN,CAAkBJ,gBAAlB;AACApB,cAAAA,OAAO;AACV,aARL,EASKM,KATL;AAUH,WAXM,CAAP;AAYH;;AA5F4C,O","sourcesContent":["import { _decorator, Component, Node, tween, Vec2, Vec3 } from \"cc\";\r\nimport { sleep } from \"../Promises\";\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass(\"EffectManager\")\r\nexport class EffectManager extends Component {\r\n  public static async decreaseScale(\r\n    target: Node,\r\n    duration: number,\r\n    yoyo: boolean\r\n  ): Promise<void> {\r\n    return new Promise<void>((resolve) => {\r\n      tween(target)\r\n        .to(duration, { scale: Vec3.ZERO })\r\n        .call(() => {\r\n          resolve();\r\n          if (yoyo) {\r\n            tween(target).to(duration, { scale: Vec3.ONE }).start();\r\n          }\r\n        })\r\n        .start();\r\n    });\r\n  }\r\n\r\n  public static async movePiece(\r\n    target: Node,\r\n    to: Vec3,\r\n    duration: number\r\n  ): Promise<void> {\r\n    return new Promise<void>((resolve) => {\r\n      tween(target)\r\n        .to(duration, {\r\n          position: to,\r\n        })\r\n        .call(() => {\r\n          resolve();\r\n        })\r\n        .start();\r\n    });\r\n  }\r\n\r\n  public static async fallPieceToGridPosition(\r\n    target: Node,\r\n    to: Vec3,\r\n    duration: number,\r\n    delay: number\r\n  ): Promise<void> {\r\n    await sleep(delay);\r\n    return new Promise<void>((resolve) => {\r\n      tween(target)\r\n        .to(duration, { position: to })\r\n        .call(() => {\r\n          resolve();\r\n        })\r\n        .start();\r\n    });\r\n  }\r\n\r\n  public static async animateRowFall(\r\n    pieceProps: any[],\r\n    duration: number,\r\n    delay: number = 0\r\n  ) {\r\n    const promises = pieceProps.map((pieceProps) => {\r\n      return this.fallPieceToGridPosition(\r\n        pieceProps.piece,\r\n        pieceProps.targetPosition,\r\n        duration,\r\n        delay\r\n      );\r\n    });\r\n    await Promise.all(promises);\r\n  }\r\n\r\n  public static highlightPiece(piece: Node) {\r\n    // piece.setScale(1.2, 1.2, 1.2);\r\n    tween(piece)\r\n    .to(0.1,{scale : new Vec3(1.2,1.2,1.2)})\r\n    .start();\r\n  }\r\n\r\n  public static async shakePiece(piece: Node, duration: number = 0.2): Promise<void> {\r\n    const originalPosition = piece.getPosition();\r\n    const shakeAmount = 10; // Sarsılma miktarı\r\n\r\n    return new Promise<void>((resolve) => {\r\n        tween(piece)\r\n            .by(duration / 4, { position: new Vec3(shakeAmount, 0, 0) }) \r\n            .by(duration / 4, { position: new Vec3(-shakeAmount * 2, 0, 0) }) \r\n            .by(duration / 4, { position: new Vec3(shakeAmount * 2, 0, 0) }) \r\n            .by(duration / 4, { position: new Vec3(-shakeAmount, 0, 0) }) \r\n            .call(() => {\r\n                piece.setPosition(originalPosition); \r\n                resolve();\r\n            })\r\n            .start();\r\n    });\r\n}\r\n}\r\n"]}