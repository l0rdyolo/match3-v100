{"version":3,"sources":["file:///C:/Users/maide/OneDrive/Documents/GitHub/match3-v100/assets/Scripts/SooLib/UI/UIManager.ts"],"names":["_decorator","SingletonComponent","PriorityQueue","ccclass","UIManager","displayItems","x","y","show","item","contains","console","warn","count","peek","hide","enqueue","priority","log","hidePopUp","tryGetTopDisplayItem","displayItem","dequeue","showTopDisplayItem","callback","clearAllPopUps"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAISA,MAAAA,U,OAAAA,U;;AAJAC,MAAAA,kB,iBAAAA,kB;;AACAC,MAAAA,a,iBAAAA,a;;;;;;;;;OAIH;AAAEC,QAAAA;AAAF,O,GAAcH,U;;2BAGPI,S,GADZD,O,UAAD,MACaC,SADb;AAAA;AAAA,oDAC6D;AAAA;AAAA;AAAA,eACjDC,YADiD,GACG;AAAA;AAAA,8CAAkB,CAACC,CAAD,EAAIC,CAAJ,KAAUA,CAAC,GAAGD,CAAhC,CADH;AAAA;;AAGzDE,QAAAA,IAAI,CAACC,IAAD,EAA2B;AAC3B,cAAI,CAACA,IAAD,IAAS,KAAKJ,YAAL,CAAkBK,QAAlB,CAA2BD,IAA3B,CAAb,EAA+C;AAC3CE,YAAAA,OAAO,CAACC,IAAR,CAAa,CAACH,IAAD,GAAQ,iCAAR,GAA4C,gCAAzD;AACA;AACH;;AAED,cAAI,KAAKJ,YAAL,CAAkBQ,KAAlB,GAA0B,CAA9B,EAAiC;AAC7B,iBAAKR,YAAL,CAAkBS,IAAlB,GAAyB,CAAzB,EAA4BC,IAA5B;AACH;;AAED,eAAKV,YAAL,CAAkBW,OAAlB,CAA0BP,IAA1B,EAAgCA,IAAI,CAACQ,QAArC;AACA,eAAKZ,YAAL,CAAkBS,IAAlB,GAAyB,CAAzB,EAA4BN,IAA5B;AACAG,UAAAA,OAAO,CAACO,GAAR,CAAY,yBAAZ,EAAuC,KAAKb,YAAL,CAAkBS,IAAlB,GAAyB,CAAzB,CAAvC;AAEH;;AAEDK,QAAAA,SAAS,GAAS;AACd,cAAI,KAAKC,oBAAL,CAA2BC,WAAD,IAAiB;AAC3C,iBAAKhB,YAAL,CAAkBiB,OAAlB;AACAD,YAAAA,WAAW,CAACN,IAAZ;AACA,iBAAKQ,kBAAL;AACH,WAJG,CAAJ,EAII;AACAZ,YAAAA,OAAO,CAACC,IAAR,CAAa,2BAAb;AACH;AACJ;;AAEOW,QAAAA,kBAAkB,GAAS;AAC/B,eAAKH,oBAAL,CAA2BC,WAAD,IAAiBA,WAAW,CAACb,IAAZ,EAA3C;AACH;;AAEOY,QAAAA,oBAAoB,CAACI,QAAD,EAAyD;AACjF,gBAAMH,WAAW,GAAG,KAAKhB,YAAL,CAAkBQ,KAAlB,GAA0B,CAA1B,GAA8B,KAAKR,YAAL,CAAkBS,IAAlB,GAAyB,CAAzB,CAA9B,GAA4D,IAAhF;;AACA,cAAIO,WAAJ,EAAiB;AACbG,YAAAA,QAAQ,CAACH,WAAD,CAAR;AACA,mBAAO,IAAP;AACH;;AACD,iBAAO,KAAP;AACH;;AAEDI,QAAAA,cAAc,GAAS;AACnB,iBAAO,KAAKpB,YAAL,CAAkBQ,KAAlB,GAA0B,CAAjC,EAAoC;AAChC,kBAAMQ,WAAW,GAAG,KAAKhB,YAAL,CAAkBiB,OAAlB,GAA4B,CAA5B,CAApB;AACAD,YAAAA,WAAW,CAACN,IAAZ;AACH;AACJ;;AA/CwD,O","sourcesContent":["import { SingletonComponent } from \"../Legacy/Singleton\";\nimport { PriorityQueue } from \"../Util/PriorityQueue\";\nimport { IDisplayItem } from \"./DisplayItem\";\n\nimport { _decorator } from \"cc\";\nconst { ccclass } = _decorator;\n\n@ccclass\nexport class UIManager extends SingletonComponent<UIManager> {\n    private displayItems: PriorityQueue<IDisplayItem, number> = new PriorityQueue((x, y) => y - x);\n\n    show(item: IDisplayItem): void {\n        if (!item || this.displayItems.contains(item)) {\n            console.warn(!item ? \"Pop-up object is null or empty!\" : \"Pop-up object is already open!\");\n            return;\n        }\n\n        if (this.displayItems.count > 0) {\n            this.displayItems.peek()[0].hide();\n        }\n\n        this.displayItems.enqueue(item, item.priority);\n        this.displayItems.peek()[0].show();\n        console.log(\"Pop-up object is shown!\", this.displayItems.peek()[0]);\n        \n    }\n\n    hidePopUp(): void {\n        if (this.tryGetTopDisplayItem((displayItem) => {\n            this.displayItems.dequeue();\n            displayItem.hide();\n            this.showTopDisplayItem();\n        })) {\n            console.warn(\"No pop-up object is open!\");\n        }\n    }\n\n    private showTopDisplayItem(): void {\n        this.tryGetTopDisplayItem((displayItem) => displayItem.show());\n    }\n\n    private tryGetTopDisplayItem(callback: (displayItem: IDisplayItem) => void): boolean {\n        const displayItem = this.displayItems.count > 0 ? this.displayItems.peek()[0] : null;\n        if (displayItem) {\n            callback(displayItem);\n            return true;\n        }\n        return false;\n    }\n\n    clearAllPopUps(): void {\n        while (this.displayItems.count > 0) {\n            const displayItem = this.displayItems.dequeue()[0];\n            displayItem.hide();\n        }\n    }\n}\n"]}