{"version":3,"sources":["file:///C:/Users/maide/OneDrive/Documents/GitHub/match3-v100/assets/Scripts/Piece/PiecePool.ts"],"names":["_decorator","Prefab","instantiate","SingletonComponent","ccclass","property","PiecePool","pool","initialPoolSize","onLoad","piecesPrefabs","length","console","warn","fillPool","i","piece","createRandomPiece","push","prefab","getRandomPrefab","newPiece","active","randomIndex","Math","floor","random","error","getPiece","pop","log","returnPiece","clearAll","forEach","destroy"],"mappings":"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","sourcesContent":["import { _decorator, Prefab, instantiate, Node } from 'cc';\nimport { SingletonComponent } from '../SingeltonComponent';\nconst { ccclass, property } = _decorator;\n\n@ccclass('PiecePool')\nexport class PiecePool extends SingletonComponent<PiecePool> {\n    @property([Prefab])\n    piecesPrefabs: Prefab[] = [];\n\n    private pool: Node[] = [];\n    private initialPoolSize: number = 10; // İstediğiniz başlangıç boyutunu buraya koyabilirsiniz\n\n    protected onLoad(): void {\n        super.onLoad();\n        if(this.piecesPrefabs.length === 0){\n            console.warn(\"There are no piece prefabs assigned.\");\n            return;\n        }\n        this.fillPool(); // Pool'u başlatırken doldur\n    }\n\n    private fillPool(): void {\n        for (let i = 0; i < this.initialPoolSize; i++) {\n            const piece = this.createRandomPiece();\n            if (piece) {\n                this.pool.push(piece);\n            }\n        }\n    }\n\n    private createRandomPiece(): Node | null {\n        const prefab = this.getRandomPrefab();\n        if (prefab) {\n            const newPiece = instantiate(prefab);\n            newPiece.active = false; // Başlangıçta pool'a eklerken aktif olmasın\n            return newPiece;\n        }\n        return null;\n    }\n\n    private getRandomPrefab(): Prefab | null {\n        if (this.piecesPrefabs.length > 0) {\n            const randomIndex = Math.floor(Math.random() * this.piecesPrefabs.length);\n            return this.piecesPrefabs[randomIndex];\n        } else {\n            console.error(\"No prefabs available in PiecePool.\");\n            return null;\n        }\n    }\n\n    public getPiece(): Node | null {\n        if (this.pool.length > 0) {\n            const piece = this.pool.pop();\n            piece!.active = true; \n            return piece!;\n        } else {\n            console.log(\"Pool is empty, generating a new piece.\");\n            const newPiece = this.createRandomPiece();\n            if (newPiece) {\n                newPiece.active = true;\n                return newPiece;\n            } else {\n                console.error(\"Failed to create a new piece.\");\n                return null;\n            }\n        }\n    }\n\n    public returnPiece(piece: Node) {\n        piece.active = false; \n        this.pool.push(piece);\n    }\n\n    public clearAll() {\n        this.pool.forEach(piece => piece.destroy());\n        this.pool = [];\n    }\n}\n"]}