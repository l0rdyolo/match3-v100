{"version":3,"sources":["file:///C:/Users/maide/OneDrive/Documents/GitHub/match3-v100/assets/Scripts/Game/GameManager.ts"],"names":["_decorator","Component","SelectionManager","SliderManager","GravityHandler","MatchChecker","ccclass","property","GameManager","onLoad","selectionManager","eventTarget","on","applySelection","pieceA","pieceB","isSelectionValid","sliderManager","Slide","matches","matchChecker","checkForMatches","length","handleMatches","Shake","resetSelection","cancelSelection","piece"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;;AAEZC,MAAAA,gB,iBAAAA,gB;;AACAC,MAAAA,a,iBAAAA,a;;AACAC,MAAAA,c,iBAAAA,c;;AACAC,MAAAA,Y,iBAAAA,Y;;;;;;;;;OAEH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;;6BAGjBQ,W,WADZF,OAAO,CAAC,aAAD,C,UAGHC,QAAQ;AAAA;AAAA,+C,UAGRA,QAAQ;AAAA;AAAA,yC,UAGRA,QAAQ;AAAA;AAAA,uC,UAGRA,QAAQ;AAAA;AAAA,2C,2BAZb,MACaC,WADb,SACiCP,SADjC,CAC2C;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;AAAA;;AAc7BQ,QAAAA,MAAM,GAAS;AACrB,eAAKC,gBAAL,CAAsBC,WAAtB,CAAkCC,EAAlC,CAAqC,gBAArC,EAAuD,KAAKC,cAA5D,EAA4E,IAA5E;AACH;;AAE2B,cAAdA,cAAc,CAACC,MAAD,EAAgBC,MAAhB,EAA8C;AACtE,cAAI,KAAKL,gBAAL,CAAsBM,gBAAtB,EAAJ,EAA8C;AAC1C,kBAAM,KAAKC,aAAL,CAAmBC,KAAnB,CAAyBJ,MAAzB,EAAiCC,MAAjC,CAAN;AACA,kBAAMI,OAAO,GAAG,KAAKC,YAAL,CAAkBC,eAAlB,CAAkCP,MAAlC,EAA0CC,MAA1C,CAAhB;;AACA,gBAAII,OAAO,CAACG,MAAR,GAAiB,CAArB,EAAwB;AACpB,mBAAKC,aAAL,CAAmBJ,OAAnB;AACH,aAFD,MAEO;AACH;AACA,oBAAM,KAAKF,aAAL,CAAmBC,KAAnB,CAAyBH,MAAzB,EAAiCD,MAAjC,CAAN;AACH;AACJ,WATD,MASO;AACHA,YAAAA,MAAM,CAACU,KAAP;AACH;AACJ;;AAEOC,QAAAA,cAAc,GAAE;AACpB,eAAKf,gBAAL,CAAsBgB,eAAtB;AACH;;AAEOH,QAAAA,aAAa,CAACJ,OAAD,EAAyB;AAC1C;AACA,eAAK,MAAMQ,KAAX,IAAoBR,OAApB,EAA6B,CACzB;AACH,WAJyC,CAK1C;;AACH;;AA3CsC,O;;;;;iBAGM,I;;;;;;;iBAGN,I;;;;;;;iBAGF,I;;;;;;;iBAGI,I","sourcesContent":["import { _decorator, Component } from 'cc';\r\nimport { Piece } from '../Piece/Piece';\r\nimport { SelectionManager } from '../Interaction/SelectionManager';\r\nimport { SliderManager } from '../Interaction/SliderManager';\r\nimport { GravityHandler } from '../Grid/GravityHandler';\r\nimport { MatchChecker } from '../Match/MatchChecker';\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('GameManager')\r\nexport class GameManager extends Component {\r\n\r\n    @property(SelectionManager)\r\n    private selectionManager: SelectionManager = null;\r\n\r\n    @property(SliderManager)\r\n    private sliderManager: SliderManager = null;\r\n\r\n    @property(MatchChecker)\r\n    private matchChecker: MatchChecker = null;\r\n\r\n    @property(GravityHandler)\r\n    private gravityHandler: GravityHandler = null;\r\n\r\n    protected onLoad(): void {\r\n        this.selectionManager.eventTarget.on('applySelection', this.applySelection, this);\r\n    }\r\n\r\n    private async applySelection(pieceA: Piece, pieceB: Piece): Promise<void> {\r\n        if (this.selectionManager.isSelectionValid()) {\r\n            await this.sliderManager.Slide(pieceA, pieceB);\r\n            const matches = this.matchChecker.checkForMatches(pieceA, pieceB);\r\n            if (matches.length > 0) {\r\n                this.handleMatches(matches);\r\n            } else {\r\n                // Eğer match yoksa parçaları geri swap et\r\n                await this.sliderManager.Slide(pieceB, pieceA);\r\n            }\r\n        } else {\r\n            pieceA.Shake();\r\n        }\r\n    }\r\n\r\n    private resetSelection(){\r\n        this.selectionManager.cancelSelection();\r\n    }\r\n\r\n    private handleMatches(matches: Piece[]): void {\r\n        // Eşleşen parçaları kaldırma işlemi\r\n        for (const piece of matches) {\r\n            // piece.destroy();\r\n        }\r\n        // this.gravityHandler.applyGravity();\r\n    }\r\n}\r\n"]}