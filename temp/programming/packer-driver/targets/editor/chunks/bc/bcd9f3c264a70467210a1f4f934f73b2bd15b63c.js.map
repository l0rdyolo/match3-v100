{"version":3,"sources":["file:///C:/Users/maide/OneDrive/Documents/GitHub/match3-2d/assets/SooLib/Optim/Poolable.ts"],"names":["_decorator","Component","instantiate","Prefab","Vec3","Quat","ObjectPooling","ccclass","property","Poolable","pool","Pool","onObjectAcquired","obj","active","onObjectReleased","setParent","node","setPosition","ZERO","setScale","ONE","setRotation","creator","poolObject","onLoad","list","i","maxCount","push"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,I,OAAAA,I;;AAC3CC,MAAAA,a,iBAAAA,a;;;;;;;;;OAChB;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBR,U,GAE9B;;0BAEsBS,Q,WADrBF,OAAO,CAAC,UAAD,C,UAEHC,QAAQ,CAACL,MAAD,C,2BAFb,MACsBM,QADtB,SACuCR,SADvC,CACiD;AAAA;AAAA;;AAAA;;AAAA;;AAAA,eAOnCS,IAPmC;AAAA;;AAS9B,YAAJC,IAAI,GAAsB;AACjC,iBAAO,KAAKD,IAAZ;AACH;;AAESE,QAAAA,gBAAgB,CAACC,GAAD,EAAkB;AACxCA,UAAAA,GAAG,CAACC,MAAJ,GAAa,IAAb,CADwC,CAExC;AACH;;AAESC,QAAAA,gBAAgB,CAACF,GAAD,EAAkB;AACxCA,UAAAA,GAAG,CAACC,MAAJ,GAAa,KAAb;AACAD,UAAAA,GAAG,CAACG,SAAJ,CAAc,KAAKC,IAAnB;AACAJ,UAAAA,GAAG,CAACK,WAAJ,CAAgBd,IAAI,CAACe,IAArB;AACAN,UAAAA,GAAG,CAACO,QAAJ,CAAahB,IAAI,CAACiB,GAAlB;AACAR,UAAAA,GAAG,CAACS,WAAJ,CAAgB,IAAIjB,IAAJ,EAAhB,EALwC,CAMxC;AACH;;AAESkB,QAAAA,OAAO,GAAS;AACtB,gBAAMV,GAAG,GAAGX,WAAW,CAAC,KAAKsB,UAAN,CAAvB;AACAX,UAAAA,GAAG,CAACG,SAAJ,CAAc,KAAKC,IAAnB;AACA,iBAAOJ,GAAP;AACH;;AAESY,QAAAA,MAAM,GAAS;AACrB,gBAAMC,IAAY,GAAG,EAArB;;AACA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKC,QAAzB,EAAmCD,CAAC,EAApC,EAAwC;AACpC,kBAAMd,GAAG,GAAG,KAAKU,OAAL,EAAZ;AACAV,YAAAA,GAAG,CAACC,MAAJ,GAAa,KAAb;AACAY,YAAAA,IAAI,CAACG,IAAL,CAAUhB,GAAV;AACH;;AAED,eAAKH,IAAL,GAAY;AAAA;AAAA,8CACR,MAAM,KAAKa,OAAL,EADE,EAEPV,GAAD,IAAS,KAAKD,gBAAL,CAAsBC,GAAtB,CAFD,EAGPA,GAAD,IAAS,KAAKE,gBAAL,CAAsBF,GAAtB,CAHD,EAIRa,IAJQ,EAKR,KAAKE,QALG,EAMR,KAAKA,QANG,CAAZ;AAQH;;AAjD4C,O;;;;;iBAEd,I;;mFAE9BpB,Q;;;;;iBAC4B,E","sourcesContent":["import { _decorator, Component, Node, instantiate, Prefab, Vec3, Quat } from 'cc';\nimport { IObjectPool, ObjectPooling } from './ObjectPooling';\nconst { ccclass, property } = _decorator;\n\n// Define the Poolable abstract class\n@ccclass('Poolable')\nexport abstract class Poolable extends Component {\n    @property(Prefab)\n    protected poolObject: Prefab = null;\n\n    @property\n    protected maxCount: number = 20;\n\n    protected pool: IObjectPool<Node>;\n\n    public get Pool(): IObjectPool<Node> {\n        return this.pool;\n    }\n\n    protected onObjectAcquired(obj: Node): void {\n        obj.active = true;\n        // other logics ...\n    }\n\n    protected onObjectReleased(obj: Node): void {\n        obj.active = false;\n        obj.setParent(this.node);\n        obj.setPosition(Vec3.ZERO);\n        obj.setScale(Vec3.ONE);\n        obj.setRotation(new Quat());\n        // other logics ...\n    }\n\n    protected creator(): Node {\n        const obj = instantiate(this.poolObject);\n        obj.setParent(this.node);\n        return obj;\n    }\n\n    protected onLoad(): void {\n        const list: Node[] = [];\n        for (let i = 0; i < this.maxCount; i++) {\n            const obj = this.creator();\n            obj.active = false;\n            list.push(obj);\n        }\n\n        this.pool = new ObjectPooling<Node>(\n            () => this.creator(),\n            (obj) => this.onObjectAcquired(obj),\n            (obj) => this.onObjectReleased(obj),\n            list,\n            this.maxCount,\n            this.maxCount\n        );\n    }\n}\n"]}